import{S as O,i as R,s as E,e as P,a as y,n as z,d as S,o as Z,b,t as T,c as q,f as c,g as f,h as C,j as te,k as $,l as x,m as M,p as j,q as A,r as le,u as ne,v as se,w as ie,x as oe}from"./utils-8bea1bed.js";function U(n){return(n==null?void 0:n.length)!==void 0?n:Array.from(n)}function V(n,e,l){const t=n.slice();return t[10]=e[l],t}function B(n){var L,G;let e,l,t=(((L=n[1])==null?void 0:L.title)??`"${n[0]}" stage actions`)+"",s,i,o,a,g,u,h,_,p,r=((G=n[1])==null?void 0:G.description)&&F(n),d=!n[4]&&!n[2]&&I(n),v=n[4]&&Q(),m=n[3]&&W(n),k=n[2]&&X();return{c(){e=b("div"),l=b("p"),s=T(t),i=q(),r&&r.c(),o=q(),a=b("div"),g=q(),u=b("div"),d&&d.c(),h=q(),v&&v.c(),_=q(),m&&m.c(),p=q(),k&&k.c(),c(l,"class","usp-cxmm3m"),c(u,"class","usp-t85iqx"),c(e,"class","usp-yg8x3z")},m(w,N){y(w,e,N),f(e,l),f(l,s),f(e,i),r&&r.m(e,null),f(e,o),f(e,a),f(e,g),f(e,u),d&&d.m(u,null),f(u,h),v&&v.m(u,null),f(e,_),m&&m.m(e,null),f(e,p),k&&k.m(e,null)},p(w,N){var H,J;N&3&&t!==(t=(((H=w[1])==null?void 0:H.title)??`"${w[0]}" stage actions`)+"")&&C(s,t),(J=w[1])!=null&&J.description?r?r.p(w,N):(r=F(w),r.c(),r.m(e,o)):r&&(r.d(1),r=null),!w[4]&&!w[2]?d?d.p(w,N):(d=I(w),d.c(),d.m(u,h)):d&&(d.d(1),d=null),w[4]?v||(v=Q(),v.c(),v.m(u,null)):v&&(v.d(1),v=null),w[3]?m?m.p(w,N):(m=W(w),m.c(),m.m(e,p)):m&&(m.d(1),m=null),w[2]?k||(k=X(),k.c(),k.m(e,null)):k&&(k.d(1),k=null)},d(w){w&&S(e),r&&r.d(),d&&d.d(),v&&v.d(),m&&m.d(),k&&k.d()}}}function F(n){var s;let e,l=((s=n[1])==null?void 0:s.description)+"",t;return{c(){e=b("p"),t=T(l),c(e,"class","usp-ohadq3")},m(i,o){y(i,e,o),f(e,t)},p(i,o){var a;o&2&&l!==(l=((a=i[1])==null?void 0:a.description)+"")&&C(t,l)},d(i){i&&S(e)}}}function I(n){let e,l=U(n[5]),t=[];for(let s=0;s<l.length;s+=1)t[s]=K(V(n,l,s));return{c(){for(let s=0;s<t.length;s+=1)t[s].c();e=P()},m(s,i){for(let o=0;o<t.length;o+=1)t[o]&&t[o].m(s,i);y(s,e,i)},p(s,i){if(i&96){l=U(s[5]);let o;for(o=0;o<l.length;o+=1){const a=V(s,l,o);t[o]?t[o].p(a,i):(t[o]=K(a),t[o].c(),t[o].m(e.parentNode,e))}for(;o<t.length;o+=1)t[o].d(1);t.length=l.length}},d(s){s&&S(e),te(t,s)}}}function ce(n){let e,l,t=n[10].input.label+"",s,i,o,a,g,u,h,_,p,r,d,v;function m(){return n[9](n[10])}return{c(){e=b("div"),l=b("label"),s=T(t),o=q(),a=b("input"),_=q(),p=b("button"),p.textContent="Submit",r=q(),c(l,"class","usp-ntzpsr"),c(l,"for",i=n[10].input.name),c(a,"id",g=n[10].input.name),c(a,"type",u=n[10].input.type),c(a,"placeholder",h=n[10].input.placeholder),c(a,"class","usp-eomizi"),c(p,"class","usp-0agbz1"),c(e,"class","usp-7hclbd")},m(k,L){y(k,e,L),f(e,l),f(l,s),f(e,o),f(e,a),f(e,_),f(e,p),f(e,r),d||(v=x(p,"click",m),d=!0)},p(k,L){n=k,L&32&&t!==(t=n[10].input.label+"")&&C(s,t),L&32&&i!==(i=n[10].input.name)&&c(l,"for",i),L&32&&g!==(g=n[10].input.name)&&c(a,"id",g),L&32&&u!==(u=n[10].input.type)&&c(a,"type",u),L&32&&h!==(h=n[10].input.placeholder)&&c(a,"placeholder",h)},d(k){k&&S(e),d=!1,v()}}}function ue(n){let e,l,t,s,i,o=n[10].name+"",a,g,u;function h(){return n[8](n[10])}return{c(){e=b("button"),l=b("img"),i=q(),a=T(o),c(l,"alt",t=n[10].name),M(l.src,s=`https://unpkg.com/lucide-static@latest/icons/${n[10].icon}.svg`)||c(l,"src",s),c(l,"class","usp-fx613u"),c(e,"class","usp-wzb5aw")},m(_,p){y(_,e,p),f(e,l),f(e,i),f(e,a),g||(u=x(e,"click",h),g=!0)},p(_,p){n=_,p&32&&t!==(t=n[10].name)&&c(l,"alt",t),p&32&&!M(l.src,s=`https://unpkg.com/lucide-static@latest/icons/${n[10].icon}.svg`)&&c(l,"src",s),p&32&&o!==(o=n[10].name+"")&&C(a,o)},d(_){_&&S(e),g=!1,u()}}}function ae(n){let e;return{c(){e=b("div"),c(e,"class","usp-mmcwjs")},m(l,t){y(l,e,t)},p:z,d(l){l&&S(e)}}}function re(n){let e,l,t,s,i,o,a=n[10].name+"",g,u,h;return{c(){e=b("a"),l=b("button"),t=b("img"),o=q(),g=T(a),u=q(),c(t,"alt",s=n[10].name),M(t.src,i=`https://unpkg.com/lucide-static@latest/icons/${n[10].icon}.svg`)||c(t,"src",i),c(t,"class","usp-fx613u"),c(l,"class","usp-wzb5aw"),c(e,"href",h=n[10].href),c(e,"target","_blank")},m(_,p){y(_,e,p),f(e,l),f(l,t),f(l,o),f(l,g),f(e,u)},p(_,p){p&32&&s!==(s=_[10].name)&&c(t,"alt",s),p&32&&!M(t.src,i=`https://unpkg.com/lucide-static@latest/icons/${_[10].icon}.svg`)&&c(t,"src",i),p&32&&a!==(a=_[10].name+"")&&C(g,a),p&32&&h!==(h=_[10].href)&&c(e,"href",h)},d(_){_&&S(e)}}}function K(n){let e;function l(i,o){if(i[10].href)return re;if(i[10].action==="META:GAP")return ae;if(i[10].action)return ue;if(i[10].input)return ce}let t=l(n),s=t&&t(n);return{c(){s&&s.c(),e=P()},m(i,o){s&&s.m(i,o),y(i,e,o)},p(i,o){t===(t=l(i))&&s?s.p(i,o):(s&&s.d(1),s=t&&t(i),s&&(s.c(),s.m(e.parentNode,e)))},d(i){i&&S(e),s&&s.d(i)}}}function Q(n){let e;return{c(){e=b("div"),e.textContent="ðŸª„ Doing the magic... ðŸª„",c(e,"class","usp-aes9dv")},m(l,t){y(l,e,t)},d(l){l&&S(e)}}}function W(n){let e,l,t,s;return{c(){e=b("div"),l=b("p"),t=T("Error: "),s=T(n[3]),c(l,"class","usp-jcb5tz"),c(e,"class","usp-tukwjd")},m(i,o){y(i,e,o),f(e,l),f(l,t),f(l,s)},p(i,o){o&8&&C(s,i[3])},d(i){i&&S(e)}}}function X(n){let e;return{c(){e=b("div"),e.innerHTML='<p class="usp-16rxvh">Success</p>',c(e,"class","usp-8opwb9")},m(l,t){y(l,e,t)},d(l){l&&S(e)}}}function fe(n){let e,l=n[1]&&B(n);return{c(){l&&l.c(),e=P()},m(t,s){l&&l.m(t,s),y(t,e,s)},p(t,[s]){t[1]?l?l.p(t,s):(l=B(t),l.c(),l.m(e.parentNode,e)):l&&(l.d(1),l=null)},i:z,o:z,d(t){t&&S(e),l&&l.d(t)}}}function pe(n,e,l){let t,s,i,o,a,g,{lead:u=null}=e;Z(async()=>{const r=document.querySelector(".pipeline-select__dropdown__item_selected");r&&l(0,t=r.innerText)});const h=async(r,d)=>{if(!u)return;let v="";if(d){const m=document.querySelector(`#${d}`);m&&(v=m.value)}l(4,o=!0),fetch(`${$}/status-update`,{method:"POST",body:JSON.stringify({status:r,input:v,lead_id:u.lead_id,contact_id:u.contact_id,email:u==null?void 0:u.email,name:u.name,responsible_user_id:u.responsible_user_id,responsible_user_name:u.responsible_user_name})}).then(()=>{l(2,g=!0)}).catch(m=>{l(3,a=m.message)}).finally(()=>{l(4,o=!1),setTimeout(()=>{l(3,a=null),l(2,g=!0)},2e3)})},_=r=>h(r.action??""),p=r=>h(r.input.name,r.input.name);return n.$$set=r=>{"lead"in r&&l(7,u=r.lead)},n.$$.update=()=>{var r,d;n.$$.dirty&129&&l(1,s=((r=u==null?void 0:u.settings)==null?void 0:r.actions[t])||((d=u==null?void 0:u.settings)==null?void 0:d.actions.default)),n.$$.dirty&2&&l(5,i=(s==null?void 0:s.actions)||[])},l(0,t="New Leads"),l(4,o=!1),l(3,a=null),l(2,g=!1),[t,s,g,a,o,i,h,u,_,p]}class de extends O{constructor(e){super(),R(this,e,pe,fe,E,{lead:7})}}function Y(n){let e,l;return e=new de({props:{lead:n[0]}}),{c(){ne(e.$$.fragment)},m(t,s){se(e,t,s),l=!0},p(t,s){const i={};s&1&&(i.lead=t[0]),e.$set(i)},i(t){l||(j(e.$$.fragment,t),l=!0)},o(t){A(e.$$.fragment,t),l=!1},d(t){ie(e,t)}}}function _e(n){let e,l,t=n[0]&&Y(n);return{c(){e=b("div"),t&&t.c(),c(e,"id","bta-integration"),c(e,"class","usp-uavpxv")},m(s,i){y(s,e,i),t&&t.m(e,null),l=!0},p(s,[i]){s[0]?t?(t.p(s,i),i&1&&j(t,1)):(t=Y(s),t.c(),j(t,1),t.m(e,null)):t&&(oe(),A(t,1,1,()=>{t=null}),le())},i(s){l||(j(t),l=!0)},o(s){A(t),l=!1},d(s){s&&S(e),t&&t.d()}}}function me(n,e,l){let t,{callback:s}=e;const i=async()=>{var a;const o=(a=window.location.href.split("/").pop())==null?void 0:a.split("?")[0];l(0,t=await(await fetch(`${$}/lead/${o}`)).json()),s()};return Z(async()=>{i()}),n.$$set=o=>{"callback"in o&&l(1,s=o.callback)},n.$$.update=()=>{n.$$.dirty&1&&console.log(t)},l(0,t=null),[t,s]}class be extends O{constructor(e){super(),R(this,e,me,_e,E,{callback:1})}}function ge(n){let e;return{c(){e=b("div"),e.textContent="Loading actions...",c(e,"class","usp-gdfgfv"),c(e,"id","bta-loader")},m(l,t){y(l,e,t)},p:z,i:z,o:z,d(l){l&&S(e)}}}class he extends O{constructor(e){super(),R(this,e,null,ge,E,{})}}const D=()=>{var s;const n=document.querySelector(".notes-wrapper__notes.js-notes"),e=document.querySelector(".notes-wrapper__online");if(console.log("load",e),!e)return;let l=null;const t=e.querySelector("#bta-loader");e.querySelector("#bta-integration")&&(console.log("remove old integration 1"),(s=e.querySelector("#bta-integration"))==null||s.remove(),t==null||t.remove()),l=new he({target:e}),new be({target:e,props:{callback:()=>{l==null||l.$destroy(),n&&setTimeout(()=>{ee.observe(n,we)},1e3)}}})};setTimeout(()=>{D()},1e3);chrome.runtime.onMessage.addListener(function(n){n.message==="urlChange"&&(console.log("urlChange"),setTimeout(()=>{D()},500))});const ve=(n,e)=>{let l;return function(...t){clearTimeout(l),l=setTimeout(()=>{n(...t)},e)}},ke=ve(D,500),ee=new MutationObserver(function(n){n.forEach(function(e){e.addedNodes.length&&(ee.disconnect(),ke())})}),we={attributes:!1,childList:!0,subtree:!0};
